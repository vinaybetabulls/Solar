!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.GoogleMapDrawFilter=e()}}(function(){return function e(t,o,n){function r(i,l){if(!o[i]){if(!t[i]){var p="function"==typeof require&&require;if(!l&&p)return p(i,!0);if(a)return a(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var u=o[i]={exports:{}};t[i][0].call(u.exports,function(e){var o=t[i][1][e];return r(o?o:e)},u,u.exports,e,t,o,n)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,o){t.exports=function(e,t){for(var o=e[0],n=e[1],r=!1,a=0,i=t.length-1;a<t.length;i=a++){var l=t[a][0],p=t[a][1],s=t[i][0],u=t[i][1],f=p>n!=u>n&&o<(s-l)*(n-p)/(u-p)+l;f&&(r=!r)}return r}},{}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){e=e||{};var t=e.apiKey,o=e.libraries||[],n=e.client,r="https://maps.googleapis.com/maps/api/js",a="3.25",i=(window.google=null,null),l=null,p=null,s=function u(){var u=r,e={key:t,callback:"CALLBACK_NAME",libraries:o.join(","),client:n,v:a,channel:i,language:l,region:p},s=Object.keys(e).filter(function(t){return!!e[t]}).map(function(t){return t+"="+e[t]}).join("&");return u+"?"+s};return s()};o.GoogleApi=n,o["default"]=n},{}],3:[function(e,t,o){(function(t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),l=function(e,t,o){for(var n=!0;n;){var r=e,a=t,i=o;n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,o=i,n=!0,l=s=void 0}},p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},s="undefined"!=typeof window?window.React:"undefined"!=typeof t?t.React:null,u=n(s),f=e("react-dom"),c=n(f),d=e("./ScriptCache"),g=n(d),h=e("./GoogleApi"),y=n(h),v={},m=function(e){var t=function(t){function o(e,t){r(this,o),l(Object.getPrototypeOf(o.prototype),"constructor",this).call(this,e,t),this.state={loaded:!1,map:null,google:null}}return a(o,t),i(o,[{key:"componentDidMount",value:function(){var e=this,t=this.refs;this.scriptCache.google.onLoad(function(o,n){var r=window.google.maps,a=(p({},e.props,{loaded:e.state.loaded}),t.map),i=c["default"].findDOMNode(a),l=new r.LatLng(e.props.lat,e.props.lng),s=p({},v,{center:l,zoom:e.props.zoom});e.map=new r.Map(i,s),e.setState({loaded:!0,map:e.map,google:window.google})})}},{key:"componentWillMount",value:function(){this.scriptCache=(0,g["default"])({google:(0,y["default"])({apiKey:this.props.apiKey,libraries:["drawing","visualization"]})})}},{key:"render",value:function(){var t=p({},this.props,{loaded:this.state.loaded,map:this.state.map,google:this.state.google,mapComponent:this.refs.map});return u["default"].createElement("div",null,u["default"].createElement(e,t),u["default"].createElement("div",{ref:"map"}))}}]),o}(u["default"].Component);return t};o.wrapper=m,o["default"]=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./GoogleApi":2,"./ScriptCache":4,"react-dom":void 0}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=0,r=new Map,a=function(e){return function(t){var o={};return o._onLoad=function(e){return function(t){var o=r.get(e);o&&o.promise.then(function(){o.error?t(o.error):t(null,o)})}},o._scriptTag=function(t,o){var a=document.createElement("script"),i=new Promise(function(i,l){var p=document.getElementsByTagName("body")[0];a.type="text/javascript",a.async=!1;var s="loaderCB"+n++ +Date.now(),u=void 0,f=function(){e[s]&&"function"==typeof e[s]&&(e[s]=null)},c=function(e){return function(n){var a=r.get(t);"loaded"===e?(a.resolved=!0,i(o)):"error"===e&&(a.errored=!0,l(n)),f()}};return a.onload=c("loaded"),a.onerror=c("error"),a.onreadystatechange=function(){c(a.readyState)},o.match(/callback=CALLBACK_NAME/)?(o=o.replace(/(callback=)[^\&]+/,"$1"+s),u=window[s]=a.onload):a.addEventListener("load",a.onload),a.addEventListener("error",a.onerror),a.src=o,p.appendChild(a),a}),l={loaded:!1,error:!1,promise:i,tag:a};return r.set(t,l),r.get(t)},Object.keys(t).forEach(function(e){var n=t[e];o[e]={tag:o._scriptTag(e,n),onLoad:o._onLoad(e)}}),o}}(window);o.ScriptCache=a,o["default"]=a},{}],5:[function(e,t,o){(function(n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),p=function(e,t,o){for(var n=!0;n;){var r=e,a=t,i=o;n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,o=i,n=!0,l=s=void 0}},s="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,u=r(s),f=e("./ApiComponents/ScriptCache"),c=(r(f),e("./ApiComponents/GoogleApi")),d=(r(c),e("./ApiComponents/GoogleApiComponent")),g=r(d),h=e("./Map"),y=r(h),v=function(e){function t(){a(this,t),p(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return i(t,e),l(t,[{key:"render",value:function(){return u["default"].createElement("div",null,u["default"].createElement(y["default"],{google:this.props.google,heatMap:this.props.heatMap,drawMode:this.props.drawMode,markers:this.props.markers,mapConfig:this.props.mapConfig,mapStyle:this.props.mapStyle,polygonOptions:this.props.polygonOptions,handleReturnedMarkers:this.props.handleReturnedMarkers,onMarkerClick:this.props.onMarkerClick,insertMarker:this.props.insertMarker,apiKey:this.props.apiKey}))}}]),t}(u["default"].Component);v.propTypes={apiKey:u["default"].PropTypes.string.isRequired,drawMode:u["default"].PropTypes.bool,heatMap:u["default"].PropTypes.bool,markers:u["default"].PropTypes.array,mapConfig:u["default"].PropTypes.object,polygonOptions:u["default"].PropTypes.object,google:u["default"].PropTypes.object,mapStyle:u["default"].PropTypes.object,handleReturnedMarkers:u["default"].PropTypes.func,onMarkerClick:u["default"].PropTypes.func,insertMarker:u["default"].PropTypes.bool},v.defaultProps={drawMode:!0,insertMarker:!1,mapConfig:{zoom:14,lat:41.384279176844764,lng:2.1526336669921875},mapStyle:{height:"600px",width:"600px"},polygonOptions:{fillColor:"#455A64",fillOpacity:.3,strokeColor:"#455A64",strokeWeight:3,clickable:!0,editable:!0,zIndex:1},markers:[]},o["default"]=(0,g["default"])(v),t.exports=o["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ApiComponents/GoogleApi":2,"./ApiComponents/GoogleApiComponent":3,"./ApiComponents/ScriptCache":4,"./Map":6}],6:[function(e,t,o){(function(n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),p=function(e,t,o){for(var n=!0;n;){var r=e,a=t,i=o;n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,o=i,n=!0,l=s=void 0}},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},u="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,f=r(u),c=e("react-dom"),d=r(c),g=e("point-in-polygon"),h=r(g),y=[],v=void 0,m=function(e){function t(){a(this,t),p(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.state={drawMode:!1,loaded:!1}}return i(t,e),l(t,[{key:"componentDidUpdate",value:function(e,t){e.google!==this.props.google&&(this.loadMap(),this.props.drawMode&&this.drawPolyline(),this.props.insertMarker&&this.insertMarker(),this.props.heatMap&&this.heatMap()),e.markers.length!==this.props.markers.length&&this.markers!=e.markers&&this.state.loaded&&!this.props.heatMap&&this.getMarkers()}},{key:"componentWillReceiveProps",value:function(e){this.props.google;v&&e.drawMode!=this.props.drawMode&&v.setDrawingMode(null),this.props.drawMode!==e.drawMode&&e.drawMode&&this.props.google&&this.drawPolyline()}},{key:"heatMap",value:function(){var e=this.props.google,t=e.maps;console.log(this.props.markers);var o=this.props.markers.map(function(t){return new e.maps.LatLng(t.latLng.lat,t.latLng.lng)});new t.visualization.HeatmapLayer({data:o,map:this.map})}},{key:"insertMarker",value:function(){var e=this.props.google,t=e.maps;e.maps.event.addListener(this.map,"click",function(o){var n=this,r={position:new e.maps.LatLng(o.latLng.lat(),o.latLng.lng()),map:this.map,draggable:!0},a=new t.Marker(r);this.props.handleReturnedMarkers({lat:o.latLng.lat(),lng:o.latLng.lng()}),a.addListener("dragend",function(e){n.props.handleReturnedMarkers({lat:e.latLng.lat(),lng:e.latLng.lng()})})}.bind(this))}},{key:"drawPolyline",value:function(){var e=this.props.google;v=new e.maps.drawing.DrawingManager({drawingMode:e.maps.drawing.OverlayType.POLYGON,drawingControl:!1,polygonOptions:this.props.polygonOptions}),v.setMap(this.map),e.maps.event.addListener(v,"polygoncomplete",function(t){var o=this;v.setDrawingMode(null);var n=t.getPath();e.maps.event.addListener(t,"click",function(e){t.setMap(null),n=[],o.getMarkers(),o.drawPolyline()});var r=function(){var e=[],t=[];n.forEach(function(t){e.push([t.lat(),t.lng()])}),y.forEach(function(n){var r=n.getPosition().lat(),a=n.getPosition().lng();(0,h["default"])([r,a],e)?(t.push(n),n.map||n.setMap(o.map)):n.setMap(null)}),o.props.handleReturnedMarkers&&o.props.handleReturnedMarkers(t)};r(),e.maps.event.addListener(n,"set_at",function(e){n=t.getPath(),r()}),e.maps.event.addListener(n,"insert_at",function(e){n=t.getPath(),r()})}.bind(this))}},{key:"getMarkers",value:function(){var e=this;console.log("getMarkers");var t=this.props.google,o=t.maps;y.forEach(function(e){e.setMap(null)}),y=[],this.props.markers.forEach(function(n){var r=s({},n,{position:new t.maps.LatLng(n.latLng.lat,n.latLng.lng),map:e.map}),a=new o.Marker(r);e.props.onMarkerClick&&t.maps.event.addListener(a,"click",function(t){e.props.onMarkerClick(a)}),a.info&&!function(){var o=new t.maps.InfoWindow({content:a.info});t.maps.event.addListener(a,"click",function(t){o.open(e.map,a)})}(),y.push(a),e.props.handleReturnedMarkers&&e.props.handleReturnedMarkers(y)})}},{key:"loadMap",value:function(){var e=this;try{var t=this.props.google,o=t.maps,n=this.refs.map,r=d["default"].findDOMNode(n),a=this.props.mapConfig,i=a.zoom,l=a.lat,p=a.lng,u=new o.LatLng(l,p),f=s({},{center:u,zoom:i});this.map=new o.Map(r,f),t.maps.event.addListenerOnce(this.map,"idle",function(){e.props.heatMap||e.getMarkers()}),this.setState({loaded:!0})}catch(c){console.log("error in load")}}},{key:"render",value:function(){return f["default"].createElement("div",{style:this.props.mapStyle,ref:"map"},"Loading map...")}}]),t}(f["default"].Component);o["default"]=m,t.exports=o["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"point-in-polygon":1,"react-dom":void 0}]},{},[5])(5)});